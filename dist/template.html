<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="Script Tutorials" />
    <title>Отображение готовности здания</title>
    <link rel="stylesheet" type="text/css" href="./css/scene.css" />
    <script>
      !function(e){var o={};function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(n,t){if(1&t&&(n=r(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)r.d(e,o,function(t){return n[t]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,e){"use strict";e.r(n);function o(){var t=document.getElementById("canvas");t.width=t.offsetWidth,t.height=t.offsetHeight;var n=t.width,e=t.height,o=t.getContext("2d");if(o){var r=function(t){return y(t.x,t.z)},i=function(t){o&&(o.clearRect(0,0,n,e),t.forEach(function(t){o.strokeStyle=t.strokeStyle,o.fillStyle=t.fillStyle,t.faces.forEach(function(t){var n=r(t[0]);o.beginPath(),o.moveTo(n.x,-n.y),t.forEach(function(t){n=r(t),o.lineTo(n.x,-n.y)}),o.closePath(),o.stroke(),o.fill()})}))},x=[],a=window.ConstructionReadinessRenderer,m={minX:0,maxX:0,minZ:0,maxZ:0},c=0;a.forEach(function(t){t["СтруктураСекций"].forEach(function(t,n){var e=t["СтруктураЭтажей"];e&&e.length&&e.length>c&&(c=e.length)})});var g=e/(c+1),b=n/2,p=g-e;a.forEach(function(t){v("title",t["Проект"]),v("footer","подвал"),t["СтруктураСекций"].forEach(function(t,h){var n=t["СтруктураЭтажей"];t["Секция"];n.forEach(function(t,n){var e,o,r,i=h*g,a=n*g,c=b+i,f=p+a,u=+t["Готовность"],l=(0===(e=u)?(o="rgba(65, 71, 71, 0.3)",r="rgba(170, 190, 190, 0.3)"):e<100?(o="rgba(17, 50, 50, 0.3)",r="rgba(51, 198, 198, 0.3)"):100===e&&(o="rgba(4, 64, 12, 0.3)",r="rgba(70, 198, 55, 0.3)"),{strokeStyle:o,fillStyle:r}),d=l.strokeStyle,s=l.fillStyle;i>m.maxX&&(m.maxX=i),a>m.maxZ&&(m.maxZ=a);var y=w(c,0,f),v=E(y,g,d,s);x.push(v)})})});var f=(m.maxX-m.minX)/2,u=(m.minZ,w(b+f,0,p));i(x);var l=!1,d=0;t.addEventListener("mousedown",function(t){l=!0,d=t.clientX,t.clientY}),document.addEventListener("mousemove",function(t){if(l){var n=(t.clientX-d)*Math.PI/360;x.forEach(function(t){t.vertices.forEach(function(t){s(t,u,n,0)})}),d=t.clientX,t.clientY,i(x)}}),document.addEventListener("mouseup",function(){l=!1});var s=function(t,n,e,o){var r=Math.cos(e),i=Math.sin(e),a=Math.cos(o),c=Math.sin(o),f=t.x-n.x,u=t.y-n.y,l=t.z-n.z;t.x=r*f-i*a*u+i*c*l+n.x,t.y=i*f+r*a*u-r*c*l+n.y,t.z=c*u+a*l+n.z}}}var w=function(t,n,e){return{x:+t,y:+n,z:+e}},y=function(t,n){return{x:+t,y:+n}},E=function(t,n,e,o){var r=n/2,i=[w(t.x-r,t.y-r,t.z+r),w(t.x-r,t.y-r,t.z-r),w(t.x+r,t.y-r,t.z-r),w(t.x+r,t.y-r,t.z+r),w(t.x+r,t.y+r,t.z+r),w(t.x+r,t.y+r,t.z-r),w(t.x-r,t.y+r,t.z-r),w(t.x-r,t.y+r,t.z+r)];return{strokeStyle:e,fillStyle:o,vertices:i,faces:[[i[0],i[1],i[2],i[3]],[i[3],i[2],i[5],i[4]],[i[4],i[5],i[6],i[7]],[i[7],i[6],i[1],i[0]],[i[7],i[0],i[3],i[4]],[i[1],i[6],i[5],i[2]]]}},v=function(t,n){document.getElementById(t).innerHTML=n};if(window.attachEvent)window.attachEvent("onload",o);else if(window.onload){var r=window.onload;window.onload=function(){r(),o()}}else window.onload=o}]);
    </script>
    <script>
      ConstructionReadinessRenderer = {jsonAnchor};
    </script>
  </head>
  <body>
    <div class="container">
      <h1 class="floatLabel title" id="title"></h1>
      <canvas id="canvas" width="100%" height="100%"></canvas>
      <p class="floatLabel footer" id="footer"></p>
    </div>
  </body>
</html>
